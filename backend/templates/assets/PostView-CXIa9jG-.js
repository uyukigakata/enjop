import{d as B,r as d,e as D,o as _,c as R,b as t,w as j,v as F,f as v,g as m,u as J,h as s,i as u,j as l,t as M,k as S,n as A,_ as O}from"./index-QwTayhIS.js";import{_ as P}from"./enjop_logo-B52kueF_.js";import{a as U}from"./axios-upsvKRUO.js";import q from"./LoadView-D6aLS2kJ.js";const z={class:"postView"},E={class:"flex items-center justify-center flex-col mt-8"},I={class:"fileupload"},$=B({__name:"PostView",setup(G){const f=J(),i=d(!1),c=d(!1),g=d(""),p=d(null),o=d({laws:[{law_id:"0",law_name:"Law Name",law_reason:"This is Reason",law_risk_level:0},{law_id:"0",law_name:"Law Name",law_reason:"This is Reason",law_risk_level:0}],comment:"解析コメント",rating:0}),w=a=>{var r;const n=((r=a.target.files)==null?void 0:r[0])||null;p.value=n},y=async()=>{console.log("start isLoading",i.value),console.log("start dialog",c.value),i.value=!0,await x(),i.value=!1,c.value=!0,console.log("end isLoading",i.value),console.log("end dialog",c.value)},x=async()=>{if(!p.value)return;const a=new FormData;a.append("file",p.value),a.append("content_str",g.value);try{const n=(await U.post("/api/process_video",a,{headers:{"Content-Type":"multipart/form-data"}})).data.openai_risk_assessment;console.log("rist_text!!!!!!!!!!!!"),console.log(n);const r=n.replace(/\\n/g,"");o.value=JSON.parse(r),console.log("responseMessage.value!!!!!!!!!!!!"),console.log(o.value),c.value=!0}catch(e){console.error(e),o.value={laws:[],comment:"An error occurred while processing the video",rating:0}}},k=()=>{const a=JSON.stringify(o.value.laws);f.push({path:"/result",query:{rating:o.value.rating,comment:o.value.comment,laws:a}})},b=D(()=>`bg-rate${o.value.rating}`);return(a,e)=>{const n=s("v-card-text"),r=s("v-divider"),h=s("v-spacer"),C=s("v-btn"),V=s("v-card-actions"),N=s("v-card"),L=s("v-dialog");return _(),R("div",z,[t("div",E,[e[2]||(e[2]=t("p",null,"1. テキストを入力",-1)),j(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=T=>g.value=T),class:"mt-2 text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400",style:{height:"80px"}},null,512),[[F,g.value]]),t("div",I,[e[1]||(e[1]=t("p",{class:"mt-4"},"2. 動画ファイルをここにアップロード",-1)),t("input",{type:"file",onChange:w,class:"mt-2 text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"},null,32)]),t("button",{onClick:y,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2"}," 投稿 ")]),i.value?(_(),v(q,{key:0})):m("",!0),c.value?(_(),v(L,{key:1,width:"500",class:"text-center",transition:"dialog-bottom-transition"},{default:u(()=>[l(N,{class:A(["enjo_dialog",b.value])},{default:u(()=>[l(n,null,{default:u(()=>[e[3]||(e[3]=t("p",{class:"dialog_kanki"},"ちょっと待って! この動画、炎上するかも...",-1)),t("p",null,"リスク評価: "+M(o.value.rating),1)]),_:1}),l(r),l(V,{class:"cardActions"},{default:u(()=>[l(h),e[5]||(e[5]=t("img",{src:P,height:"90",alt:"logo"},null,-1)),l(C,{color:"blue darken-1",onClick:k},{default:u(()=>e[4]||(e[4]=[S(" 詳しく見る ")])),_:1})]),_:1})]),_:1},8,["class"])]),_:1})):m("",!0)])}}}),X=O($,[["__scopeId","data-v-a9fb6116"]]);export{X as default};
