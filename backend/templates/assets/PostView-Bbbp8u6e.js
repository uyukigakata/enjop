import{d as D,r as d,e as R,c as m,b as t,f,g as _,w as j,v as F,h as u,i as s,u as J,o as g,j as i,n as M,t as S,k as A,_ as O}from"./index-BbO9enD1.js";import{_ as P}from"./enjop_logo-B52kueF_.js";import{a as U}from"./index-C88pvD_q.js";import q from"./LoadView-Dokitx6M.js";const z={class:"postView"},E={class:"flex items-center justify-center flex-col mt-8"},I={class:"fileupload"},$={key:0,class:"progress-bar-bg"},G=D({__name:"PostView",setup(H){const w=J(),r=d(!1),c=d(!1),p=d(""),v=d(null),o=d({laws:[{law_id:"0",law_name:"Law Name",law_reason:"This is Reason",law_risk_level:0},{law_id:"0",law_name:"Law Name",law_reason:"This is Reason",law_risk_level:0}],comment:"解析コメント",rating:0}),y=a=>{var n;const l=((n=a.target.files)==null?void 0:n[0])||null;v.value=l},x=async()=>{console.log("start isLoading",r.value),console.log("start dialog",c.value),r.value=!0,await b(),r.value=!1,c.value=!0,console.log("end isLoading",r.value),console.log("end dialog",c.value)},b=async()=>{if(!v.value)return;const a=new FormData;a.append("file",v.value),a.append("content_str",p.value);try{const l=(await U.post("/api/process_video",a,{headers:{"Content-Type":"multipart/form-data"}})).data.openai_risk_assessment;console.log("rist_text!!!!!!!!!!!!"),console.log(l);const n=l.replace(/\\n/g,"");o.value=JSON.parse(n),console.log("responseMessage.value!!!!!!!!!!!!"),console.log(o.value),c.value=!0}catch(e){console.error(e),o.value={laws:[],comment:"An error occurred while processing the video",rating:0}}},k=()=>{const a=JSON.stringify(o.value.laws);w.push({path:"/result",query:{rating:o.value.rating,comment:o.value.comment,laws:a}})},h=R(()=>`bg-rate${o.value.rating}`);return(a,e)=>{const l=s("v-card-text"),n=s("v-divider"),C=s("v-spacer"),V=s("v-btn"),N=s("v-card-actions"),L=s("v-card"),T=s("v-dialog");return g(),m("div",z,[t("div",E,[e[3]||(e[3]=t("p",null,"1. テキストを入力",-1)),j(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=B=>p.value=B),class:"mt-2 text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400",style:{height:"80px"}},null,512),[[F,p.value]]),t("div",I,[e[1]||(e[1]=t("p",{class:"mt-4"},"2. 動画ファイルをここにアップロード",-1)),t("input",{type:"file",onChange:y,class:"mt-2 text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"},null,32)]),t("button",{onClick:x,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2"}," 投稿 "),r.value?(g(),m("div",$,e[2]||(e[2]=[t("div",{class:"progress-bar"},null,-1)]))):_("",!0)]),r.value?(g(),f(q,{key:0})):_("",!0),c.value?(g(),f(T,{key:1,width:"500",class:"text-center",transition:"dialog-bottom-transition"},{default:u(()=>[i(L,{class:M(["enjo_dialog",h.value])},{default:u(()=>[i(l,null,{default:u(()=>[e[4]||(e[4]=t("p",{class:"dialog_kanki"},"ちょっと待って! この動画、炎上するかも...",-1)),t("p",null,"リスク評価: "+S(o.value.rating),1)]),_:1}),i(n),i(N,{class:"cardActions"},{default:u(()=>[i(C),e[6]||(e[6]=t("img",{src:P,height:"90",alt:"logo"},null,-1)),i(V,{color:"blue darken-1",onClick:k},{default:u(()=>e[5]||(e[5]=[A(" 詳しく見る ")])),_:1})]),_:1})]),_:1},8,["class"])]),_:1})):_("",!0)])}}}),Y=O(G,[["__scopeId","data-v-f1c755a4"]]);export{Y as default};
